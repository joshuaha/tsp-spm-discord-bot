CREATE TABLE POLL ( 
	POLL_ID CHAR(5) PRIMARY KEY,
	OWNER_ID BIGINT NOT NULL, 
	TEXT VARCHAR(128), 
	OPEN_TIME DATETIME NOT NULL, 
	CLOSE_TIME DATETIME NOT NULL,
	SERVER_ID BIGINT NOT NULL,
	CHANNEL_ID BIGINT NOT NULL,
	MESSAGE_ID BIGINT NOT NULL,
	UNIQUE INDEX MESSAGE (SERVER_ID, CHANNEL_ID, MESSAGE_ID)
);

CREATE TABLE OPTION (
	POLL_ID CHAR(5),
	OPTION_ID TINYINT,
	TEXT VARCHAR(128),
	PRIMARY KEY (POLL_ID, OPTION_ID),
	FOREIGN KEY (POLL_ID) REFERENCES POLL (POLL_ID)
);

CREATE TABLE VOTE (
	POLL_ID CHAR(5),
	OPTION_ID TINYINT,
	USER_ID BIGINT,
	PRIMARY KEY (USER_ID, POLL_ID),
	FOREIGN KEY (POLL_ID, OPTION_ID) REFERENCES OPTION (POLL_ID, OPTION_ID)
);
